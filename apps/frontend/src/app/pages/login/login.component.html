<div class="login-container">
  <h2 class="title">Hello there! Welcome to the world of pokémon!</h2>
  <h3 class="title">{{ title() }}</h3>

  <form [formGroup]="loginForm" (ngSubmit)="onSubmit()" class="login-form">
    <div class="pokeball-icon">
      <div class="pokeball-inner"></div>
    </div>

    @if (mode() === "register") {
      <label>
        Name
        <input
          type="text"
          formControlName="name"
          placeholder="Enter your name"
        />
      </label>

      @if (
        controls.name.invalid && (controls.name.dirty || controls.name.touched)
      ) {
        <span class="error">
          @if (controls.name.errors?.["required"]) {
            <div>Name is required.</div>
          }
          @if (controls.name.errors?.["minlength"]) {
            <div>Must be at least 2 characters long.</div>
          }
        </span>
      }
    }

    <label
      >Email
      <input
        type="email"
        formControlName="email"
        placeholder="Enter your email"
      />
    </label>
    @if (
      controls.email.invalid && (controls.email.dirty || controls.email.touched)
    ) {
      <span class="error">
        @if (controls.email.errors?.["required"]) {
          <div>Email is required.</div>
        }
        @if (controls.email.errors?.["email"]) {
          <div>Please enter a valid email address.</div>
        }
      </span>
    }

    <label
      >Password
      <input
        type="password"
        formControlName="password"
        placeholder="Enter your password"
      />
    </label>
    @if (controls.password.invalid && controls.password.dirty) {
      <div class="error">Min 6 characters required.</div>
    }

    <button type="submit" [disabled]="loading() || loginForm.invalid">
      {{
        loading()
          ? mode() === "login"
            ? "Logging in…"
            : "Registering…"
          : mode() === "login"
            ? "Login"
            : "Register"
      }}
    </button>

    @if (error()) {
      <p class="error">{{ error() }}</p>
    }

    <div class="toggle-mode">
      @if (mode() === "login") {
        Don’t have an account?
        <a (click)="toggleMode()">Register here</a>
      } @else {
        Already a trainer?
        <a (click)="toggleMode()">Login here</a>
      }
    </div>
  </form>
</div>
